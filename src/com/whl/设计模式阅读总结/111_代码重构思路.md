### 重构的目的

重构是一种对软件内部结构的改善，目的是在不改变软件可见行为的情况下，使其更易理解，修改成本更低。该定义中，“重构不改变外部的可见行为”强调了我们需要在保持功能不变的前提下，利用设计思想、原则、模式、规范等理论来优化代码，修改设计上的不足，提高代码质量。

项目需要演进，代码也在不停地堆砌，如果不对原有的腐化代码进行重构，代码就会越来越混乱，当累积的混乱到达一定的程度之后，重构的成本就已经高过了重新开发项目的成本，此时若想重构基本是不可能的了。最真实的例子就是90后最熟悉的网游——dnf，在游戏刚开服时，安装包仅仅600MB左右大小，迭代到今天，dnf已经12岁了，代码量累计到了20多G，将近30G，而且游戏的优化我想玩过的人都知道这里就不多说了。其实并不是工程师们不想优化，而是累计了20多G，代码已经很难优化重构了。

优秀的代码和架构并不是一开始就能够完全设计好的，因为我们无法预见未来的演进、需求的变化，因此重构也无法避免。



### 重构的对象

根据重构的规模，可以简单分为：大型重构与小型重构。大型重构指的是对顶层代码设计的重构，包括：系统、模块、代码结构、类与类之间的关系等重构。这类重构难度大、耗时长、也很可能会有重构之后引入bug的风险。小型重构指的是对代码细节的重构，主要是针对类、函数、变量等代码级别的重构，例如规范命名、规范注释、分解超大类或函数、提取重复代码等。这类重构要修改的地方比较集中，比较简单，耗时会比较短，引入 bug 的风险相对来说也会比较小。



### 重构的时机

之前也说了，不可能一开始就能够写出完美的代码，因此要正确看待代码质量和重构的观念。技术在更新、需求在变化，代码质量总会不可避免地下降，因此我们要在平时就养成持续重构的意识，在Coding的时候看看项目中有没有可以优化的代码，有的话就可以顺手把那些不符合规范的代码重构一下。



### 如何重构

对于大型重构来说，如果耦合比较严重，代码质量比较差，很可能牵一发而动全身。因此要提前做好完善的重构计划，分阶段进行。每个阶段的重构完成后，测试运行发现没有问题之后，再进行下一阶段的重构。